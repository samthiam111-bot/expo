{"version":3,"file":"load.js","names":["_nodeFs","data","_interopRequireDefault","require","nodeModule","_interopRequireWildcard","_nodePath","_nodeUrl","_codeframe","_transform","e","__esModule","default","_getRequireWildcardCache","WeakMap","r","t","has","get","n","__proto__","a","Object","defineProperty","getOwnPropertyDescriptor","u","hasOwnProperty","call","i","set","_ts","loadTypescript","undefined","error","code","parent","module","tsExtensionMapping","maybeReadFileSync","filename","fs","readFileSync","toFormat","isLegacy","endsWith","compileModule","opts","format","prependPaths","paths","nodeModulePaths","_nodeModulePaths","path","dirname","mod","assign","Module","_compile","loaded","cache","children","splice","indexOf","hasStripTypeScriptTypes","stripTypeScriptTypes","evalModule","inputCode","inputFilename","diagnostic","ts","ModuleKind","CommonJS","ESNext","Preserve","output","transpileModule","fileName","reportDiagnostics","compilerOptions","moduleResolution","ModuleResolutionKind","Bundler","verbatimModuleSyntax","target","ScriptTarget","newLine","NewLineKind","LineFeed","inlineSourceMap","esModuleInterop","outputText","diagnostics","length","mode","sourceMap","ext","extname","inputExt","join","basename","toCommonJS","exports","diagnosticError","formatDiagnostic","annotateError","requireOrImport","Promise","resolve","isAbsolute","url","pathToFileURL","toString","then","s","loadModule","loadModuleSync","isTypeScript"],"sources":["../src/load.ts"],"sourcesContent":["import fs from 'node:fs';\nimport * as nodeModule from 'node:module';\nimport path from 'node:path';\nimport url from 'node:url';\nimport type * as ts from 'typescript';\n\nimport { annotateError, formatDiagnostic } from './codeframe';\nimport { toCommonJS } from './transform';\n\ndeclare module 'node:module' {\n  export function _nodeModulePaths(base: string): readonly string[];\n}\n\ndeclare global {\n  namespace NodeJS {\n    export interface Module {\n      _compile(\n        code: string,\n        filename: string,\n        format?: 'module' | 'commonjs' | 'commonjs-typescript' | 'module-typescript' | 'typescript'\n      ): unknown;\n    }\n  }\n}\n\nlet _ts: typeof import('typescript') | null | undefined;\nfunction loadTypescript() {\n  if (_ts === undefined) {\n    try {\n      _ts = require('typescript');\n    } catch (error: any) {\n      if (error.code !== 'MODULE_NOT_FOUND') {\n        throw error;\n      } else {\n        _ts = null;\n      }\n    }\n  }\n  return _ts;\n}\n\nconst parent = module;\n\nconst tsExtensionMapping: Record<string, string | undefined> = {\n  '.ts': '.js',\n  '.cts': '.cjs',\n  '.mts': '.mjs',\n};\n\nfunction maybeReadFileSync(filename: string) {\n  try {\n    return fs.readFileSync(filename, 'utf8');\n  } catch (error: any) {\n    if (error.code === 'ENOENT') {\n      return null;\n    }\n    throw error;\n  }\n}\n\ntype Format = 'commonjs' | 'module' | 'module-typescript' | 'commonjs-typescript' | 'typescript';\n\nfunction toFormat(filename: string, isLegacy: true): Format;\nfunction toFormat(filename: string, isLegacy: false): Format | null;\nfunction toFormat(filename: string, isLegacy: boolean): Format | null {\n  if (filename.endsWith('.cjs')) {\n    return 'commonjs';\n  } else if (filename.endsWith('.mjs')) {\n    return 'module';\n  } else if (filename.endsWith('.js')) {\n    return isLegacy ? 'commonjs' : null;\n  } else if (filename.endsWith('.mts')) {\n    return 'module-typescript';\n  } else if (filename.endsWith('.cts')) {\n    return 'commonjs-typescript';\n  } else if (filename.endsWith('.ts')) {\n    return isLegacy ? 'commonjs-typescript' : 'typescript';\n  } else {\n    return null;\n  }\n}\n\nexport interface ModuleOptions {\n  paths?: string[];\n}\n\nfunction compileModule(code: string, filename: string, opts: ModuleOptions) {\n  const format = toFormat(filename, false);\n  const prependPaths = opts.paths ?? [];\n  const nodeModulePaths = nodeModule._nodeModulePaths(path.dirname(filename));\n  const paths = [...prependPaths, ...nodeModulePaths];\n  try {\n    const mod = Object.assign(new nodeModule.Module(filename, parent), { filename, paths });\n    mod._compile(code, filename, format != null ? format : undefined);\n    mod.loaded = true;\n    require.cache[filename] = mod;\n    parent?.children?.splice(parent.children.indexOf(mod), 1);\n    return mod;\n  } catch (error: any) {\n    delete require.cache[filename];\n    throw error;\n  }\n}\n\nconst hasStripTypeScriptTypes = typeof nodeModule.stripTypeScriptTypes === 'function';\n\nfunction evalModule(\n  code: string,\n  filename: string,\n  opts: ModuleOptions = {},\n  format: Format = toFormat(filename, true)\n) {\n  let inputCode = code;\n  let inputFilename = filename;\n  let diagnostic: ts.Diagnostic | undefined;\n  if (\n    format === 'typescript' ||\n    format === 'module-typescript' ||\n    format === 'commonjs-typescript'\n  ) {\n    const ts = loadTypescript();\n\n    if (ts) {\n      let module: ts.ModuleKind;\n      if (format === 'commonjs-typescript') {\n        module = ts.ModuleKind.CommonJS;\n      } else if (format === 'module-typescript') {\n        module = ts.ModuleKind.ESNext;\n      } else {\n        // NOTE(@kitten): We can \"preserve\" the output, meaning, it can either be ESM or CJS\n        // and stop TypeScript from either transpiling it to CommonJS or adding an `export {}`\n        // if no exports are used. This allows the user to choose if this file is CJS or ESM\n        // (but not to mix both)\n        module = ts.ModuleKind.Preserve;\n      }\n      const output = ts.transpileModule(code, {\n        fileName: filename,\n        reportDiagnostics: true,\n        compilerOptions: {\n          module,\n          moduleResolution: ts.ModuleResolutionKind.Bundler,\n          // `verbatimModuleSyntax` needs to be off, to erase as many imports as possible\n          verbatimModuleSyntax: false,\n          target: ts.ScriptTarget.ESNext,\n          newLine: ts.NewLineKind.LineFeed,\n          inlineSourceMap: true,\n          esModuleInterop: true,\n        },\n      });\n      inputCode = output?.outputText || inputCode;\n      if (output?.diagnostics?.length) {\n        diagnostic = output.diagnostics[0];\n      }\n    }\n\n    if (hasStripTypeScriptTypes && inputCode === code) {\n      // This may throw its own error, but this contains a code-frame already\n      inputCode = nodeModule.stripTypeScriptTypes(code, {\n        mode: 'transform',\n        sourceMap: true,\n      });\n    }\n\n    if (inputCode !== code) {\n      const ext = path.extname(filename);\n      const inputExt = tsExtensionMapping[ext] ?? ext;\n      if (inputExt !== ext) {\n        inputFilename = path.join(path.dirname(filename), path.basename(filename, ext) + inputExt);\n      }\n    }\n  } else if (format === 'commonjs') {\n    inputCode = toCommonJS(filename, code);\n  }\n\n  try {\n    const mod = compileModule(inputCode, inputFilename, opts);\n    if (inputFilename !== filename) {\n      require.cache[filename] = mod;\n    }\n    return mod.exports;\n  } catch (error: any) {\n    // If we have a diagnostic from TypeScript, we issue its error with a codeframe first,\n    // since it's likely more useful than the eval error\n    const diagnosticError = formatDiagnostic(diagnostic);\n    if (diagnosticError) {\n      throw diagnosticError;\n    }\n    throw annotateError(code, filename, error) ?? error;\n  }\n}\n\nasync function requireOrImport(filename: string) {\n  try {\n    return require(filename);\n  } catch {\n    return await import(\n      path.isAbsolute(filename) ? url.pathToFileURL(filename).toString() : filename\n    );\n  }\n}\n\nasync function loadModule(filename: string) {\n  try {\n    return await requireOrImport(filename);\n  } catch (error: any) {\n    if (error.code === 'ERR_UNKNOWN_FILE_EXTENSION' || error.code === 'MODULE_NOT_FOUND') {\n      return loadModuleSync(filename);\n    } else {\n      throw error;\n    }\n  }\n}\n\n/** Require module or evaluate with TypeScript\n * NOTE: Requiring ESM has been added in all LTS versions (Node 20.19+, 22.12+, 24).\n * This already forms the minimum required Node version as of Expo SDK 54 */\nfunction loadModuleSync(filename: string) {\n  const format = toFormat(filename, true);\n  const isTypeScript =\n    format === 'module-typescript' || format === 'commonjs-typescript' || format === 'typescript';\n  try {\n    if (format !== 'module' && !isTypeScript) {\n      return require(filename);\n    }\n  } catch (error: any) {\n    if (error.code === 'MODULE_NOT_FOUND') {\n      throw error;\n    } else if (format == null) {\n      const code = maybeReadFileSync(filename);\n      throw annotateError(code, filename, error) || error;\n    }\n    // We fallback to always evaluating the entrypoint module\n    // This is out of safety, since we're not trusting the requiring ESM feature\n    // and evaluating the module manually bypasses the error when it's flagged off\n  }\n\n  // Load from cache manually, if `loaded` is set and exports are defined, to avoid\n  // double transform or double evaluation\n  if (require.cache[filename]?.exports && require.cache[filename].loaded) {\n    return require.cache[filename].exports;\n  }\n\n  const code = fs.readFileSync(filename, 'utf8');\n  return evalModule(code, filename, {}, format);\n}\n\nexport { evalModule, loadModule, loadModuleSync };\n"],"mappings":";;;;;;;;AAAA,SAAAA,QAAA;EAAA,MAAAC,IAAA,GAAAC,sBAAA,CAAAC,OAAA;EAAAH,OAAA,YAAAA,CAAA;IAAA,OAAAC,IAAA;EAAA;EAAA,OAAAA,IAAA;AAAA;AACA,SAAAG,WAAA;EAAA,MAAAH,IAAA,GAAAI,uBAAA,CAAAF,OAAA;EAAAC,UAAA,YAAAA,CAAA;IAAA,OAAAH,IAAA;EAAA;EAAA,OAAAA,IAAA;AAAA;AACA,SAAAK,UAAA;EAAA,MAAAL,IAAA,GAAAC,sBAAA,CAAAC,OAAA;EAAAG,SAAA,YAAAA,CAAA;IAAA,OAAAL,IAAA;EAAA;EAAA,OAAAA,IAAA;AAAA;AACA,SAAAM,SAAA;EAAA,MAAAN,IAAA,GAAAC,sBAAA,CAAAC,OAAA;EAAAI,QAAA,YAAAA,CAAA;IAAA,OAAAN,IAAA;EAAA;EAAA,OAAAA,IAAA;AAAA;AAGA,SAAAO,WAAA;EAAA,MAAAP,IAAA,GAAAE,OAAA;EAAAK,UAAA,YAAAA,CAAA;IAAA,OAAAP,IAAA;EAAA;EAAA,OAAAA,IAAA;AAAA;AACA,SAAAQ,WAAA;EAAA,MAAAR,IAAA,GAAAE,OAAA;EAAAM,UAAA,YAAAA,CAAA;IAAA,OAAAR,IAAA;EAAA;EAAA,OAAAA,IAAA;AAAA;AAAyC,SAAAC,uBAAAQ,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAAA,SAAAG,yBAAAH,CAAA,6BAAAI,OAAA,mBAAAC,CAAA,OAAAD,OAAA,IAAAE,CAAA,OAAAF,OAAA,YAAAD,wBAAA,YAAAA,CAAAH,CAAA,WAAAA,CAAA,GAAAM,CAAA,GAAAD,CAAA,KAAAL,CAAA;AAAA,SAAAL,wBAAAK,CAAA,EAAAK,CAAA,SAAAA,CAAA,IAAAL,CAAA,IAAAA,CAAA,CAAAC,UAAA,SAAAD,CAAA,eAAAA,CAAA,uBAAAA,CAAA,yBAAAA,CAAA,WAAAE,OAAA,EAAAF,CAAA,QAAAM,CAAA,GAAAH,wBAAA,CAAAE,CAAA,OAAAC,CAAA,IAAAA,CAAA,CAAAC,GAAA,CAAAP,CAAA,UAAAM,CAAA,CAAAE,GAAA,CAAAR,CAAA,OAAAS,CAAA,KAAAC,SAAA,UAAAC,CAAA,GAAAC,MAAA,CAAAC,cAAA,IAAAD,MAAA,CAAAE,wBAAA,WAAAC,CAAA,IAAAf,CAAA,oBAAAe,CAAA,OAAAC,cAAA,CAAAC,IAAA,CAAAjB,CAAA,EAAAe,CAAA,SAAAG,CAAA,GAAAP,CAAA,GAAAC,MAAA,CAAAE,wBAAA,CAAAd,CAAA,EAAAe,CAAA,UAAAG,CAAA,KAAAA,CAAA,CAAAV,GAAA,IAAAU,CAAA,CAAAC,GAAA,IAAAP,MAAA,CAAAC,cAAA,CAAAJ,CAAA,EAAAM,CAAA,EAAAG,CAAA,IAAAT,CAAA,CAAAM,CAAA,IAAAf,CAAA,CAAAe,CAAA,YAAAN,CAAA,CAAAP,OAAA,GAAAF,CAAA,EAAAM,CAAA,IAAAA,CAAA,CAAAa,GAAA,CAAAnB,CAAA,EAAAS,CAAA,GAAAA,CAAA;AAkBzC,IAAIW,GAAmD;AACvD,SAASC,cAAcA,CAAA,EAAG;EACxB,IAAID,GAAG,KAAKE,SAAS,EAAE;IACrB,IAAI;MACFF,GAAG,GAAG3B,OAAO,CAAC,YAAY,CAAC;IAC7B,CAAC,CAAC,OAAO8B,KAAU,EAAE;MACnB,IAAIA,KAAK,CAACC,IAAI,KAAK,kBAAkB,EAAE;QACrC,MAAMD,KAAK;MACb,CAAC,MAAM;QACLH,GAAG,GAAG,IAAI;MACZ;IACF;EACF;EACA,OAAOA,GAAG;AACZ;AAEA,MAAMK,MAAM,GAAGC,MAAM;AAErB,MAAMC,kBAAsD,GAAG;EAC7D,KAAK,EAAE,KAAK;EACZ,MAAM,EAAE,MAAM;EACd,MAAM,EAAE;AACV,CAAC;AAED,SAASC,iBAAiBA,CAACC,QAAgB,EAAE;EAC3C,IAAI;IACF,OAAOC,iBAAE,CAACC,YAAY,CAACF,QAAQ,EAAE,MAAM,CAAC;EAC1C,CAAC,CAAC,OAAON,KAAU,EAAE;IACnB,IAAIA,KAAK,CAACC,IAAI,KAAK,QAAQ,EAAE;MAC3B,OAAO,IAAI;IACb;IACA,MAAMD,KAAK;EACb;AACF;AAMA,SAASS,QAAQA,CAACH,QAAgB,EAAEI,QAAiB,EAAiB;EACpE,IAAIJ,QAAQ,CAACK,QAAQ,CAAC,MAAM,CAAC,EAAE;IAC7B,OAAO,UAAU;EACnB,CAAC,MAAM,IAAIL,QAAQ,CAACK,QAAQ,CAAC,MAAM,CAAC,EAAE;IACpC,OAAO,QAAQ;EACjB,CAAC,MAAM,IAAIL,QAAQ,CAACK,QAAQ,CAAC,KAAK,CAAC,EAAE;IACnC,OAAOD,QAAQ,GAAG,UAAU,GAAG,IAAI;EACrC,CAAC,MAAM,IAAIJ,QAAQ,CAACK,QAAQ,CAAC,MAAM,CAAC,EAAE;IACpC,OAAO,mBAAmB;EAC5B,CAAC,MAAM,IAAIL,QAAQ,CAACK,QAAQ,CAAC,MAAM,CAAC,EAAE;IACpC,OAAO,qBAAqB;EAC9B,CAAC,MAAM,IAAIL,QAAQ,CAACK,QAAQ,CAAC,KAAK,CAAC,EAAE;IACnC,OAAOD,QAAQ,GAAG,qBAAqB,GAAG,YAAY;EACxD,CAAC,MAAM;IACL,OAAO,IAAI;EACb;AACF;AAMA,SAASE,aAAaA,CAACX,IAAY,EAAEK,QAAgB,EAAEO,IAAmB,EAAE;EAC1E,MAAMC,MAAM,GAAGL,QAAQ,CAACH,QAAQ,EAAE,KAAK,CAAC;EACxC,MAAMS,YAAY,GAAGF,IAAI,CAACG,KAAK,IAAI,EAAE;EACrC,MAAMC,eAAe,GAAG9C,UAAU,CAAD,CAAC,CAAC+C,gBAAgB,CAACC,mBAAI,CAACC,OAAO,CAACd,QAAQ,CAAC,CAAC;EAC3E,MAAMU,KAAK,GAAG,CAAC,GAAGD,YAAY,EAAE,GAAGE,eAAe,CAAC;EACnD,IAAI;IACF,MAAMI,GAAG,GAAGhC,MAAM,CAACiC,MAAM,CAAC,KAAInD,UAAU,CAAD,CAAC,CAACoD,MAAM,EAACjB,QAAQ,EAAEJ,MAAM,CAAC,EAAE;MAAEI,QAAQ;MAAEU;IAAM,CAAC,CAAC;IACvFK,GAAG,CAACG,QAAQ,CAACvB,IAAI,EAAEK,QAAQ,EAAEQ,MAAM,IAAI,IAAI,GAAGA,MAAM,GAAGf,SAAS,CAAC;IACjEsB,GAAG,CAACI,MAAM,GAAG,IAAI;IACjBvD,OAAO,CAACwD,KAAK,CAACpB,QAAQ,CAAC,GAAGe,GAAG;IAC7BnB,MAAM,EAAEyB,QAAQ,EAAEC,MAAM,CAAC1B,MAAM,CAACyB,QAAQ,CAACE,OAAO,CAACR,GAAG,CAAC,EAAE,CAAC,CAAC;IACzD,OAAOA,GAAG;EACZ,CAAC,CAAC,OAAOrB,KAAU,EAAE;IACnB,OAAO9B,OAAO,CAACwD,KAAK,CAACpB,QAAQ,CAAC;IAC9B,MAAMN,KAAK;EACb;AACF;AAEA,MAAM8B,uBAAuB,GAAG,OAAO3D,UAAU,CAAD,CAAC,CAAC4D,oBAAoB,KAAK,UAAU;AAErF,SAASC,UAAUA,CACjB/B,IAAY,EACZK,QAAgB,EAChBO,IAAmB,GAAG,CAAC,CAAC,EACxBC,MAAc,GAAGL,QAAQ,CAACH,QAAQ,EAAE,IAAI,CAAC,EACzC;EACA,IAAI2B,SAAS,GAAGhC,IAAI;EACpB,IAAIiC,aAAa,GAAG5B,QAAQ;EAC5B,IAAI6B,UAAqC;EACzC,IACErB,MAAM,KAAK,YAAY,IACvBA,MAAM,KAAK,mBAAmB,IAC9BA,MAAM,KAAK,qBAAqB,EAChC;IACA,MAAMsB,EAAE,GAAGtC,cAAc,CAAC,CAAC;IAE3B,IAAIsC,EAAE,EAAE;MACN,IAAIjC,MAAqB;MACzB,IAAIW,MAAM,KAAK,qBAAqB,EAAE;QACpCX,MAAM,GAAGiC,EAAE,CAACC,UAAU,CAACC,QAAQ;MACjC,CAAC,MAAM,IAAIxB,MAAM,KAAK,mBAAmB,EAAE;QACzCX,MAAM,GAAGiC,EAAE,CAACC,UAAU,CAACE,MAAM;MAC/B,CAAC,MAAM;QACL;QACA;QACA;QACA;QACApC,MAAM,GAAGiC,EAAE,CAACC,UAAU,CAACG,QAAQ;MACjC;MACA,MAAMC,MAAM,GAAGL,EAAE,CAACM,eAAe,CAACzC,IAAI,EAAE;QACtC0C,QAAQ,EAAErC,QAAQ;QAClBsC,iBAAiB,EAAE,IAAI;QACvBC,eAAe,EAAE;UACf1C,MAAM;UACN2C,gBAAgB,EAAEV,EAAE,CAACW,oBAAoB,CAACC,OAAO;UACjD;UACAC,oBAAoB,EAAE,KAAK;UAC3BC,MAAM,EAAEd,EAAE,CAACe,YAAY,CAACZ,MAAM;UAC9Ba,OAAO,EAAEhB,EAAE,CAACiB,WAAW,CAACC,QAAQ;UAChCC,eAAe,EAAE,IAAI;UACrBC,eAAe,EAAE;QACnB;MACF,CAAC,CAAC;MACFvB,SAAS,GAAGQ,MAAM,EAAEgB,UAAU,IAAIxB,SAAS;MAC3C,IAAIQ,MAAM,EAAEiB,WAAW,EAAEC,MAAM,EAAE;QAC/BxB,UAAU,GAAGM,MAAM,CAACiB,WAAW,CAAC,CAAC,CAAC;MACpC;IACF;IAEA,IAAI5B,uBAAuB,IAAIG,SAAS,KAAKhC,IAAI,EAAE;MACjD;MACAgC,SAAS,GAAG9D,UAAU,CAAD,CAAC,CAAC4D,oBAAoB,CAAC9B,IAAI,EAAE;QAChD2D,IAAI,EAAE,WAAW;QACjBC,SAAS,EAAE;MACb,CAAC,CAAC;IACJ;IAEA,IAAI5B,SAAS,KAAKhC,IAAI,EAAE;MACtB,MAAM6D,GAAG,GAAG3C,mBAAI,CAAC4C,OAAO,CAACzD,QAAQ,CAAC;MAClC,MAAM0D,QAAQ,GAAG5D,kBAAkB,CAAC0D,GAAG,CAAC,IAAIA,GAAG;MAC/C,IAAIE,QAAQ,KAAKF,GAAG,EAAE;QACpB5B,aAAa,GAAGf,mBAAI,CAAC8C,IAAI,CAAC9C,mBAAI,CAACC,OAAO,CAACd,QAAQ,CAAC,EAAEa,mBAAI,CAAC+C,QAAQ,CAAC5D,QAAQ,EAAEwD,GAAG,CAAC,GAAGE,QAAQ,CAAC;MAC5F;IACF;EACF,CAAC,MAAM,IAAIlD,MAAM,KAAK,UAAU,EAAE;IAChCmB,SAAS,GAAG,IAAAkC,uBAAU,EAAC7D,QAAQ,EAAEL,IAAI,CAAC;EACxC;EAEA,IAAI;IACF,MAAMoB,GAAG,GAAGT,aAAa,CAACqB,SAAS,EAAEC,aAAa,EAAErB,IAAI,CAAC;IACzD,IAAIqB,aAAa,KAAK5B,QAAQ,EAAE;MAC9BpC,OAAO,CAACwD,KAAK,CAACpB,QAAQ,CAAC,GAAGe,GAAG;IAC/B;IACA,OAAOA,GAAG,CAAC+C,OAAO;EACpB,CAAC,CAAC,OAAOpE,KAAU,EAAE;IACnB;IACA;IACA,MAAMqE,eAAe,GAAG,IAAAC,6BAAgB,EAACnC,UAAU,CAAC;IACpD,IAAIkC,eAAe,EAAE;MACnB,MAAMA,eAAe;IACvB;IACA,MAAM,IAAAE,0BAAa,EAACtE,IAAI,EAAEK,QAAQ,EAAEN,KAAK,CAAC,IAAIA,KAAK;EACrD;AACF;AAEA,eAAewE,eAAeA,CAAClE,QAAgB,EAAE;EAC/C,IAAI;IACF,OAAOpC,OAAO,CAACoC,QAAQ,CAAC;EAC1B,CAAC,CAAC,MAAM;IACN,OAAO,MAAAmE,OAAA,CAAAC,OAAA,IACLvD,mBAAI,CAACwD,UAAU,CAACrE,QAAQ,CAAC,GAAGsE,kBAAG,CAACC,aAAa,CAACvE,QAAQ,CAAC,CAACwE,QAAQ,CAAC,CAAC,GAAGxE,QAAQ,IAAAyE,IAAA,CAAAC,CAAA,IAAA5G,uBAAA,CAAAF,OAAA,CAAA8G,CAAA,GAC9E;EACH;AACF;AAEA,eAAeC,UAAUA,CAAC3E,QAAgB,EAAE;EAC1C,IAAI;IACF,OAAO,MAAMkE,eAAe,CAAClE,QAAQ,CAAC;EACxC,CAAC,CAAC,OAAON,KAAU,EAAE;IACnB,IAAIA,KAAK,CAACC,IAAI,KAAK,4BAA4B,IAAID,KAAK,CAACC,IAAI,KAAK,kBAAkB,EAAE;MACpF,OAAOiF,cAAc,CAAC5E,QAAQ,CAAC;IACjC,CAAC,MAAM;MACL,MAAMN,KAAK;IACb;EACF;AACF;;AAEA;AACA;AACA;AACA,SAASkF,cAAcA,CAAC5E,QAAgB,EAAE;EACxC,MAAMQ,MAAM,GAAGL,QAAQ,CAACH,QAAQ,EAAE,IAAI,CAAC;EACvC,MAAM6E,YAAY,GAChBrE,MAAM,KAAK,mBAAmB,IAAIA,MAAM,KAAK,qBAAqB,IAAIA,MAAM,KAAK,YAAY;EAC/F,IAAI;IACF,IAAIA,MAAM,KAAK,QAAQ,IAAI,CAACqE,YAAY,EAAE;MACxC,OAAOjH,OAAO,CAACoC,QAAQ,CAAC;IAC1B;EACF,CAAC,CAAC,OAAON,KAAU,EAAE;IACnB,IAAIA,KAAK,CAACC,IAAI,KAAK,kBAAkB,EAAE;MACrC,MAAMD,KAAK;IACb,CAAC,MAAM,IAAIc,MAAM,IAAI,IAAI,EAAE;MACzB,MAAMb,IAAI,GAAGI,iBAAiB,CAACC,QAAQ,CAAC;MACxC,MAAM,IAAAiE,0BAAa,EAACtE,IAAI,EAAEK,QAAQ,EAAEN,KAAK,CAAC,IAAIA,KAAK;IACrD;IACA;IACA;IACA;EACF;;EAEA;EACA;EACA,IAAI9B,OAAO,CAACwD,KAAK,CAACpB,QAAQ,CAAC,EAAE8D,OAAO,IAAIlG,OAAO,CAACwD,KAAK,CAACpB,QAAQ,CAAC,CAACmB,MAAM,EAAE;IACtE,OAAOvD,OAAO,CAACwD,KAAK,CAACpB,QAAQ,CAAC,CAAC8D,OAAO;EACxC;EAEA,MAAMnE,IAAI,GAAGM,iBAAE,CAACC,YAAY,CAACF,QAAQ,EAAE,MAAM,CAAC;EAC9C,OAAO0B,UAAU,CAAC/B,IAAI,EAAEK,QAAQ,EAAE,CAAC,CAAC,EAAEQ,MAAM,CAAC;AAC/C","ignoreList":[]}