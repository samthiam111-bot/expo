{"version":3,"file":"StackHeaderComponent.js","sourceRoot":"","sources":["../../../src/layouts/stack-utils/StackHeaderComponent.tsx"],"names":[],"mappings":";;AA6GA,oDAuBC;AAED,0EAoDC;AAzLD,iCAAgD;AAChD,+CAA2E;AAG3E,qFAAmF;AA8DnF;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;GAyCG;AACH,SAAgB,oBAAoB,CAAC,EACnC,QAAQ,EACR,MAAM,EACN,OAAO,EACP,WAAW,EACX,UAAU,EACV,KAAK,EACL,UAAU,GACO;IACjB,MAAM,OAAO,GAAG,IAAA,eAAO,EACrB,GAAG,EAAE,CACH,+BAA+B,CAC7B,EAAE;IACF,8CAA8C;IAC9C,EAAE,QAAQ,EAAE,MAAM,EAAE,OAAO,EAAE,WAAW,EAAE,UAAU,EAAE,KAAK,EAAE,UAAU,EAGtE,CACF,EACH,CAAC,QAAQ,EAAE,MAAM,EAAE,OAAO,EAAE,WAAW,EAAE,UAAU,EAAE,KAAK,EAAE,UAAU,CAAC,CACxE,CAAC;IACF,IAAA,0CAAoB,EAAC,OAAO,CAAC,CAAC;IAC9B,OAAO,IAAI,CAAC;AACd,CAAC;AAED,SAAgB,+BAA+B,CAC7C,OAAqC,EACrC,KAAuB;IAEvB,MAAM,cAAc,GAAG,yBAAU,CAAC,OAAO,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC;IACvD,MAAM,mBAAmB,GAAG,yBAAU,CAAC,OAAO,CAAC,KAAK,CAAC,UAAU,CAAC,CAAC;IAEjE,IAAI,KAAK,CAAC,MAAM,EAAE,CAAC;QACjB,OAAO,EAAE,GAAG,OAAO,EAAE,WAAW,EAAE,KAAK,EAAE,CAAC;IAC5C,CAAC;IAED,IAAI,KAAK,CAAC,OAAO,EAAE,CAAC;QAClB,OAAO,EAAE,GAAG,OAAO,EAAE,MAAM,EAAE,GAAG,EAAE,CAAC,KAAK,CAAC,QAAQ,EAAE,CAAC;IACtD,CAAC;IAED,IAAI,KAAK,CAAC,QAAQ,IAAI,CAAC,KAAK,CAAC,OAAO,EAAE,CAAC;QACrC,OAAO,CAAC,IAAI,CAAC,4EAA4E,CAAC,CAAC;IAC7F,CAAC;IAED,6CAA6C;IAC7C,2CAA2C;IAC3C,sDAAsD;IACtD,yEAAyE;IACzE,MAAM,uBAAuB,GAAG,cAAc,EAAE,eAAe,KAAK,aAAa,CAAC;IAClF,MAAM,aAAa,GAAG,KAAK,CAAC,UAAU,KAAK,SAAS,CAAC;IACrD,MAAM,mBAAmB,GACvB,KAAK,CAAC,WAAW,KAAK,IAAI;QAC1B,CAAC,KAAK,CAAC,WAAW,KAAK,KAAK,IAAI,CAAC,uBAAuB,IAAI,aAAa,CAAC,CAAC,CAAC;IAE9E,gEAAgE;IAChE,IAAI,KAAK,CAAC,UAAU,IAAI,KAAK,CAAC,WAAW,KAAK,KAAK,EAAE,CAAC;QACpD,OAAO,CAAC,IAAI,CAAC,kEAAkE,CAAC,CAAC;IACnF,CAAC;IAED,OAAO;QACL,GAAG,OAAO;QACV,WAAW,EAAE,CAAC,KAAK,CAAC,MAAM;QAC1B,gBAAgB,EAAE,KAAK,CAAC,UAAU;QAClC,GAAG,CAAC,mBAAmB,IAAI,EAAE,iBAAiB,EAAE,IAAI,EAAE,CAAC;QACvD,GAAG,CAAC,KAAK,CAAC,WAAW,KAAK,KAAK,IAAI,EAAE,iBAAiB,EAAE,KAAK,EAAE,CAAC;QAChE,GAAG,CAAC,cAAc,EAAE,KAAK,IAAI,EAAE,eAAe,EAAE,cAAc,CAAC,KAAe,EAAE,CAAC;QACjF,WAAW,EAAE;YACX,eAAe,EAAE,cAAc,EAAE,eAAqC;SACvE;QACD,gBAAgB,EAAE;YAChB,eAAe,EAAE,mBAAmB,EAAE,eAAqC;SAC5E;QACD,GAAG,CAAC,cAAc,EAAE,WAAW,KAAK,aAAa,IAAI,EAAE,mBAAmB,EAAE,KAAK,EAAE,CAAC;QACpF,GAAG,CAAC,mBAAmB,EAAE,WAAW,KAAK,aAAa,IAAI;YACxD,6BAA6B,EAAE,KAAK;SACrC,CAAC;KACH,CAAC;AACJ,CAAC","sourcesContent":["import { NativeStackNavigationOptions } from '@react-navigation/native-stack';\nimport { useMemo, type ReactNode } from 'react';\nimport { StyleSheet, type ColorValue, type StyleProp } from 'react-native';\nimport type { ScreenStackHeaderConfigProps } from 'react-native-screens';\n\nimport { useCompositionOption } from '../../fork/native-stack/composition-options';\n\nexport interface StackHeaderProps {\n  /**\n   * Child elements for custom header when `asChild` is true.\n   */\n  children?: ReactNode;\n  /**\n   * Whether to hide the header completely. When set to `true`, the header will not be rendered.\n   *\n   * @default false\n   */\n  hidden?: boolean;\n  /**\n   * When `true`, renders children as a custom header component, replacing the default header entirely.\n   * Use this to implement fully custom header layouts.\n   *\n   * @default false\n   */\n  asChild?: boolean;\n  /**\n   * Whether the header should be transparent.\n   * When `true`, the header is absolutely positioned and content scrolls underneath.\n   *\n   * Auto-enabled when:\n   * - `style.backgroundColor` is 'transparent'\n   * - `blurEffect` is set (required for blur to work)\n   *\n   * @default false\n   */\n  transparent?: boolean;\n  /**\n   * The blur effect to apply to the header background on iOS.\n   * Common values include 'regular', 'prominent', 'systemMaterial', etc.\n   *\n   * @platform ios\n   */\n  blurEffect?: ScreenStackHeaderConfigProps['blurEffect'];\n  /**\n   * Style properties for the standard-sized header.\n   * - `color`: Tint color for header elements (similar to tintColor in React Navigation)\n   * - `backgroundColor`: Background color of the header\n   * - `shadowColor`: Set to 'transparent' to hide the header shadow/border\n   */\n  style?: StyleProp<{\n    color?: ColorValue; // tintColor from ReactNavigation\n    backgroundColor?: ScreenStackHeaderConfigProps['backgroundColor'];\n    shadowColor?: undefined | 'transparent';\n  }>;\n  /**\n   * Style properties for the large title header (iOS).\n   * - `backgroundColor`: Background color of the large title header\n   * - `shadowColor`: Set to 'transparent' to hide the large title shadow/border\n   *\n   * @platform ios\n   */\n  largeStyle?: StyleProp<{\n    backgroundColor?: ScreenStackHeaderConfigProps['largeTitleBackgroundColor'];\n    shadowColor?: undefined | 'transparent';\n  }>;\n}\n\n/**\n * The component used to configure header styling for a stack screen.\n *\n * Use this component to set header appearance properties like blur effect, background color,\n * and shadow visibility.\n *\n * @example\n * ```tsx\n * import { Stack } from 'expo-router';\n *\n * export default function Page() {\n *   return (\n *     <>\n *       <Stack.Header\n *         blurEffect=\"systemMaterial\"\n *         style={{ backgroundColor: '#fff' }}\n *       />\n *       <ScreenContent />\n *     </>\n *   );\n * }\n * ```\n *\n * @example\n * When used inside a layout with Stack.Screen:\n * ```tsx\n * import { Stack } from 'expo-router';\n *\n * export default function Layout() {\n *   return (\n *     <Stack>\n *       <Stack.Screen name=\"index\">\n *         <Stack.Header blurEffect=\"systemMaterial\" />\n *       </Stack.Screen>\n *     </Stack>\n *   );\n * }\n * ```\n *\n * > **Note:** If multiple instances of this component are rendered for the same screen,\n * the last one rendered in the component tree takes precedence.\n */\nexport function StackHeaderComponent({\n  children,\n  hidden,\n  asChild,\n  transparent,\n  blurEffect,\n  style,\n  largeStyle,\n}: StackHeaderProps) {\n  const options = useMemo(\n    () =>\n      appendStackHeaderPropsToOptions(\n        {},\n        // satisfies ensures every prop is listed here\n        { children, hidden, asChild, transparent, blurEffect, style, largeStyle } satisfies Record<\n          keyof StackHeaderProps,\n          unknown\n        >\n      ),\n    [children, hidden, asChild, transparent, blurEffect, style, largeStyle]\n  );\n  useCompositionOption(options);\n  return null;\n}\n\nexport function appendStackHeaderPropsToOptions(\n  options: NativeStackNavigationOptions,\n  props: StackHeaderProps\n): NativeStackNavigationOptions {\n  const flattenedStyle = StyleSheet.flatten(props.style);\n  const flattenedLargeStyle = StyleSheet.flatten(props.largeStyle);\n\n  if (props.hidden) {\n    return { ...options, headerShown: false };\n  }\n\n  if (props.asChild) {\n    return { ...options, header: () => props.children };\n  }\n\n  if (props.children && !props.asChild) {\n    console.warn(`To render a custom header, set the 'asChild' prop to true on Stack.Header.`);\n  }\n\n  // Determine if header should be transparent:\n  // 1. Explicitly set via `transparent` prop\n  // 2. Implicitly via backgroundColor === 'transparent'\n  // 3. Implicitly when blurEffect is set (required for blurEffect to work)\n  const isBackgroundTransparent = flattenedStyle?.backgroundColor === 'transparent';\n  const hasBlurEffect = props.blurEffect !== undefined;\n  const shouldBeTransparent =\n    props.transparent === true ||\n    (props.transparent !== false && (isBackgroundTransparent || hasBlurEffect));\n\n  // Warn if blurEffect is set but transparent is explicitly false\n  if (props.blurEffect && props.transparent === false) {\n    console.warn(`Stack.Header: 'blurEffect' requires 'transparent' to be enabled.`);\n  }\n\n  return {\n    ...options,\n    headerShown: !props.hidden,\n    headerBlurEffect: props.blurEffect,\n    ...(shouldBeTransparent && { headerTransparent: true }),\n    ...(props.transparent === false && { headerTransparent: false }),\n    ...(flattenedStyle?.color && { headerTintColor: flattenedStyle.color as string }),\n    headerStyle: {\n      backgroundColor: flattenedStyle?.backgroundColor as string | undefined,\n    },\n    headerLargeStyle: {\n      backgroundColor: flattenedLargeStyle?.backgroundColor as string | undefined,\n    },\n    ...(flattenedStyle?.shadowColor === 'transparent' && { headerShadowVisible: false }),\n    ...(flattenedLargeStyle?.shadowColor === 'transparent' && {\n      headerLargeTitleShadowVisible: false,\n    }),\n  };\n}\n"]}